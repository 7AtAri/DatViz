---
title: "Report"
header-includes:
  - \usepackage[ngerman]{babel}
  - \DeclareUnicodeCharacter{308}{oe}  
author: "Nourhan Omar, Vipin Singh, Sara Wahl"
date: "`r Sys.Date()`"

encoding: utf8
output: 
  bookdown::html_document2:
    toc: true
    toc_float: yes
    code_folding: hide
  bookdown::pdf_document2:
    toc: false
    keep_tex: true
---
```{r setup, include=FALSE}
params <- list(html=knitr::is_html_output())
knitr::opts_chunk$set(echo = params$html)
rm(list = ls(all.names = TRUE)) # reset the environment
source("Setup.R")
```


(ref:latexInCaption) A caption can contain _underscores_ and $\sqrt v$ formulae.

# Introduction

For our data visualization project we were searching for a dataset that not only holds tabular data but also images. The idea was to use image data to train and visualize the insides of a neural network but also investigate relationships in tabular data and connect or compare the findings. We were happy to find a dataset that fit our wishes on Kaggle, and originally was used for the *PetFinder.my Adoption Prediction* challenge.

# The Dataset

todo: describe the dataset:

- number and properties of variables
- for our project, we only used the train data because the test data does not have the AdoptionSpeed column, since this had to be predicted in the challenge the dataset was originally used for.
- amount of data points 
- When accessing the dataset, we realized it also already had sentiment analysis data  included, that was run on the description column.
- necessary preprocessing

```{r pet summary, echo=FALSE}
summary(petdata) # basic data statistics
# sum(is.na(petdata)==TRUE) # sum of NAs in data
# (dim(petdata)[1]*dim(petdata)[2]) # Sum of all datapoints
na_ratio<-sum(is.na(petdata)==TRUE)/(dim(petdata)[1]*dim(petdata)[2])# ratio of NAs among all datapoints
print(na_ratio*100)
print("% of NAs among all datapoints")# percentage of NAs in data

```

# Data Exploration

- distributions of variables / summary
- pairs plot
- correlation plot
- distributions of sentiment scores


```{r, corr plot, echo=FALSE}

#names_num <- names(which(sapply(petdata, is.numeric)))

#pairs(petdata[, names_num[1:10]])
#pairs(petdata[, names_num[11:20]])

#pairs(petdata[c("Age","Breed1","Fee","Quantity","VideoAmt","PhotoAmt")])
pairs(petdata[c("Age","Fee","Quantity","VideoAmt","PhotoAmt","SentimentScore","AdoptionSpeed", "Health","Vaccinated","ColorID1")])

petdata_reduced<-na.omit(petdata) # for the correlation plot, all NAs need to be removed

corr_mat=cor(petdata_reduced[,c("Age","Fee","Quantity","VideoAmt","PhotoAmt","SentimentScore","AdoptionSpeed", "Health","Vaccinated","ColorID1")], method="s") #create Spearman correlation matrix

corrplot(corr_mat, method = "color",
     type = "upper", order = "hclust", 
     tl.col = "black", tl.cex=0.8) 

```

# Key Visuals

- compare cats and dogs...
- visualize sentiment analysis
- sentiment analysis vs adoption speed
- r-tsne of neural net embedding vectors for images

# Summary/Findings

# References

The R package **bookdown** is documented in an online book by its author Yihui Xie (2023). In this brief demo, I demonstrate some basic aspects of the use of the R package **bookdown** that took me some more time to figure out from that documentation. The package **bookdown** is based on the package **knitr** (see, e.g., https://yihui.org/knitr/), and the possibilities of that package can also be used. For example, it is possible to incorporate not only R code (like in this demo), but also, e.g., Python or Julia code with the respective code chunks.

In Chapter&nbsp;\@ref(sec:meinreflabel2) you find a figure with a simple caption that was created by the `fig.cap` entry in the chunk information, and a table that was created with function `knitr::kable`. In Chapter&nbsp;\@ref(sec:meinreflabel3) you find a figure whose caption contains underscores and a formula; because of these complications, the figure caption has to be defined as a reference (see above, "(ref:latexInCaption)") before it can be used in the chunk information; I have made it a personal convention to always define all such references at the top of the file. Such a reference can be used everywhere in the text. If you have more than one reference definition, always have an empty line between any two such definitions (there is only one here).

You can have unnumbered chapters (while most chapters are numbered), see the appendix.

 
With the **bookdown** package, it is easy to reference back an forth between sections, and to figures or tables that were created from code chunks. References to figures start with "fig:", references to tables with "tab:", and section references are entirely defined in the curly brackets after the heading, starting with "#".  The syntax for **bookdown** references is "\@ref(your reference target)",  see examples in this file. They are translated to the appropriate way of referencing for pdf or html files, as appropriate.





# Second chapter{#sec:meinreflabel2}

Table&nbsp;\@ref(tab:cor) shows the correlations in the dataset `swiss`.

```{r cor}
knitr::kable(round(cor(swiss),4), caption="The correlation matrix of the `swiss` data", booktabs=TRUE, linesep="")
```

Figure&nbsp;\@ref(fig:kde) shows a kernel density estimate of the proportion of males involved in agricultural occupations.

```{r kde, fig.cap="Proportion of males involved in agricultural occupations in 47 French speaking swiss provinces (1888). Kernel density estimate.", fig.height=3, fig.width=4}
plot(density(swiss$Agriculture), xlab="Agriculture")
```

# Third chapter{#sec:meinreflabel3}

Figure&nbsp;\@ref(fig:scat) shows a scatter plot with a more demanding figure caption.

```{r scat, fig.cap="(ref:latexInCaption)", fig.height=3, fig.width=4}
plot(Fertility~Agriculture, swiss)
```

# Final chapter
Your final chapter \textendash&nbsp;like your introductury chapter \textendash&nbsp;will be read by every reader. Both these chapters are therefore particularly important. 

Please note that this brief text focused on how to implement a report with the help of R package **bookdown**. There was not content of specific relevance for data visualization.

# References{-}
Xie, Y. (2023). bookdown: Authoring Books and Technical Documents with R Mardown. https://bookdown.org/yihui/bookdown/ (Status: May 08, 2023).

# Appendix A{-}
Example for an appendix

The following listing shows the data (do not do that with a large data set!).

```{r printdat}
print(swiss)
```

